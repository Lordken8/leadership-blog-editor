<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLAME Leadership - Admin Dashboard</title>

    <style>
        :root {
            --primary-color: #1e40af;
            --primary-light: #3b82f6;
            --secondary-color: #64748b;
            --accent-color: #f59e0b;
            --success-color: #10b981;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --border-color: #e5e7eb;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .header {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            padding: 1rem 1.5rem;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            font-size: 1.5rem;
        }

        .logo-text {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .admin-badge {
            background: var(--success-color);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .header-actions {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-primary);
            color: var(--text-primary);
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            background: var(--bg-secondary);
            border-color: var(--primary-color);
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .btn-primary:hover {
            background: var(--primary-light);
        }

        .btn-danger {
            background: #ef4444;
            color: white;
            border-color: #ef4444;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        .welcome-section {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
        }

        .welcome-title {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .welcome-subtitle {
            color: var(--text-secondary);
            font-size: 1.125rem;
            margin-bottom: 1.5rem;
        }

        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow-sm);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .action-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
        }

        .action-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .action-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .action-description {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .recent-articles {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .article-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .article-item:last-child {
            border-bottom: none;
        }

        .article-info {
            flex: 1;
        }

        .article-title {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .article-meta {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .article-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }

            .actions-grid {
                grid-template-columns: 1fr;
            }

            .quick-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .main-content {
                padding: 1.5rem 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <span class="logo-icon">üî•</span>
                <span class="logo-text">FLAME Leadership</span>
                <span class="admin-badge">ADMIN</span>
            </div>
            <div class="header-actions">
                <a href="articles.html" class="btn">
                    <span>üìö</span>
                    View Articles
                </a>
                <button class="btn btn-danger" id="logoutBtn">
                    <span>üö™</span>
                    Logout
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Welcome Section -->
        <section class="welcome-section">
            <h1 class="welcome-title">Welcome to FLAME Leadership Admin</h1>
            <p class="welcome-subtitle">Manage your fire leadership content and inspire excellence in emergency services.</p>
        </section>

        <!-- Quick Stats -->
        <section class="quick-stats">
            <div class="stat-card">
                <div class="stat-value" id="totalArticles">0</div>
                <div class="stat-label">Total Articles</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalWords">0</div>
                <div class="stat-label">Total Words</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="avgReadTime">0</div>
                <div class="stat-label">Avg Read Time</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="storageUsed">0%</div>
                <div class="stat-label">Storage Used</div>
            </div>
        </section>

        <!-- Action Cards -->
        <section class="actions-grid">
            <div class="action-card">
                <div class="action-icon">‚úèÔ∏è</div>
                <h3 class="action-title">Create New Article</h3>
                <p class="action-description">Write a new leadership article with our professional editor. Perfect for sharing insights and best practices.</p>
                <a href="editor.html" class="btn btn-primary">Start Writing</a>
            </div>

            <div class="action-card">
                <div class="action-icon">‚öôÔ∏è</div>
                <h3 class="action-title">Full CMS</h3>
                <p class="action-description">Access the complete content management system with advanced features, article management, and export tools.</p>
                <a href="index.html" class="btn btn-primary">Open CMS</a>
            </div>

            <div class="action-card">
                <div class="action-icon">üì§</div>
                <h3 class="action-title">Export Content</h3>
                <p class="action-description">Export your articles for Flowtrack.co or generate clean HTML for external platforms.</p>
                <button class="btn" onclick="openExportHelp()">Export Options</button>
            </div>

            <div class="action-card">
                <div class="action-icon">üìä</div>
                <h3 class="action-title">Analytics</h3>
                <p class="action-description">View detailed statistics about your content library, reading times, and article performance.</p>
                <button class="btn" onclick="showAnalytics()">View Stats</button>
            </div>
        </section>

        <!-- Recent Articles -->
        <section class="recent-articles">
            <h2 class="section-title">Recent Articles</h2>
            <div id="recentArticlesList">
                <div style="text-align: center; color: #6b7280; padding: 2rem;">
                    <p>Loading recent articles...</p>
                </div>
            </div>
        </section>
    </main>

    <script>
        /**
         * FLAME Leadership Admin Dashboard
         */
        class AdminDashboard {
            constructor() {
                this.sessionKey = 'flameAdminSession';
                this.storageKey = 'leadershipBlogArticles';

                this.checkAuthentication();
                this.loadDashboardData();
                this.setupEventListeners();
            }

            checkAuthentication() {
                try {
                    const session = JSON.parse(localStorage.getItem(this.sessionKey));

                    if (!session || !session.authenticated || Date.now() >= session.expires) {
                        window.location.href = 'admin.html?redirect=dashboard.html';
                        return;
                    }
                } catch (error) {
                    localStorage.removeItem(this.sessionKey);
                    window.location.href = 'admin.html?redirect=dashboard.html';
                    return;
                }
            }

            setupEventListeners() {
                document.getElementById('logoutBtn').addEventListener('click', () => {
                    if (confirm('Are you sure you want to logout?')) {
                        localStorage.removeItem(this.sessionKey);
                        window.location.href = 'admin.html';
                    }
                });
            }

            loadDashboardData() {
                try {
                    const articles = this.getStoredArticles();
                    this.updateStats(articles);
                    this.displayRecentArticles(articles);
                } catch (error) {
                    console.error('Error loading dashboard data:', error);
                }
            }

            getStoredArticles() {
                try {
                    const stored = localStorage.getItem(this.storageKey);
                    return stored ? JSON.parse(stored) : [];
                } catch (error) {
                    return [];
                }
            }

            updateStats(articles) {
                const totalArticles = articles.length;
                const totalWords = articles.reduce((sum, article) => sum + (article.wordCount || 0), 0);
                const avgReadTime = totalArticles > 0 ? Math.ceil(totalWords / totalArticles / 200) : 0;
                const storageUsed = this.calculateStorageUsage();

                document.getElementById('totalArticles').textContent = totalArticles;
                document.getElementById('totalWords').textContent = totalWords.toLocaleString();
                document.getElementById('avgReadTime').textContent = `${avgReadTime} min`;
                document.getElementById('storageUsed').textContent = `${storageUsed}%`;
            }

            calculateStorageUsage() {
                try {
                    let totalSize = 0;
                    for (let key in localStorage) {
                        if (localStorage.hasOwnProperty(key)) {
                            totalSize += localStorage[key].length;
                        }
                    }
                    const usagePercent = Math.round((totalSize / (5 * 1024 * 1024)) * 100); // Assuming 5MB limit
                    return Math.min(usagePercent, 100);
                } catch (error) {
                    return 0;
                }
            }

            displayRecentArticles(articles) {
                const container = document.getElementById('recentArticlesList');

                if (articles.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; color: #6b7280; padding: 2rem;">
                            <p>No articles found. <a href="editor.html" style="color: #1e40af;">Create your first article</a></p>
                        </div>
                    `;
                    return;
                }

                // Sort by date and take the 5 most recent
                const recentArticles = articles
                    .sort((a, b) => new Date(b.createdAt || b.publicationDate) - new Date(a.createdAt || a.publicationDate))
                    .slice(0, 5);

                container.innerHTML = recentArticles.map(article => {
                    const date = new Date(article.publicationDate || article.createdAt).toLocaleDateString();
                    const wordCount = article.wordCount || 0;

                    return `
                        <div class="article-item">
                            <div class="article-info">
                                <div class="article-title">${this.escapeHtml(article.title)}</div>
                                <div class="article-meta">
                                    ${article.author ? `By ${this.escapeHtml(article.author)} ‚Ä¢ ` : ''}
                                    ${date} ‚Ä¢ ${wordCount} words
                                </div>
                            </div>
                            <div class="article-actions">
                                <button class="btn btn-sm" onclick="adminDashboard.editArticle('${article.id}')">Edit</button>
                                <button class="btn btn-sm" onclick="adminDashboard.duplicateArticle('${article.id}')">Copy</button>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            editArticle(articleId) {
                // Store the article ID to load in the CMS
                localStorage.setItem('loadArticleId', articleId);
                window.location.href = 'index.html';
            }

            duplicateArticle(articleId) {
                // This would be implemented in the full CMS
                window.location.href = `index.html?action=duplicate&id=${articleId}`;
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        // Global functions for action cards
        function openExportHelp() {
            alert('Export Options:\n\n1. Use the Full CMS for complete export features\n2. Create articles in the Editor and use "Export for Flowtrack"\n3. Generate clean HTML for external platforms\n\nClick "Full CMS" to access all export tools.');
        }

        function showAnalytics() {
            alert('Detailed analytics are available in the Full CMS.\n\nClick "Full CMS" to view:\n‚Ä¢ Article performance\n‚Ä¢ Reading time analysis\n‚Ä¢ Content statistics\n‚Ä¢ Storage usage details');
        }

        // Initialize dashboard
        let adminDashboard;
        document.addEventListener('DOMContentLoaded', () => {
            adminDashboard = new AdminDashboard();
        });
    </script>
</body>
</html>